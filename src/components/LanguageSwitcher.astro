---
const languages = [
  { code: "en", name: "English" },
  { code: "zh", name: "中文" },
];
---

<div class="language-switcher">
  <select
    id="language-select"
    class="bg-white/80 backdrop-blur-sm rounded-lg px-3 py-2 text-gray-700 focus:outline-none focus:ring-2 focus:ring-purple-500"
  >
    {languages.map(({ code, name }) => <option value={code}>{name}</option>)}
  </select>
</div>

<script>
  import i18next from "../i18n/i18n";

  const select = document.getElementById(
    "language-select"
  ) as HTMLSelectElement;

  // 设置初始选中的语言
  select.value = i18next.language.split("-")[0];

  // 监听语言切换
  select.addEventListener("change", (e) => {
    const newLang = (e.target as HTMLSelectElement).value;
    window.location.search = `lang=${newLang}`;
  });
</script>

<style>
  .language-switcher {
    position: fixed;
    top: 1rem;
    right: 1rem;
    z-index: 50;
  }

  select {
    appearance: none;
    padding-right: 2rem;
    background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 24 24' stroke='currentColor'%3E%3Cpath stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='M19 9l-7 7-7-7'%3E%3C/path%3E%3C/svg%3E");
    background-repeat: no-repeat;
    background-position: right 0.5rem center;
    background-size: 1.5em 1.5em;
  }
</style>
